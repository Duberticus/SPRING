Round_16 = "8B1E4BA8F3A1"
#str2bits = "1000 1011 0001 1110 0100 1011 1010 1000 1111 0011 1010 0001"

Round_15= "BB9D874D36B3"
#str2bits = 101110111001110110000111010011010011011010110011

CypherText = "39783581497F2C68D67E7FC5A62346B320239CD93DC232C1580B612054B3C5C203320B583D8AA7C572F4D30977CBE55DDB99FE096554DBA1"

PC2 = [
    14,17,11,24,1,5,
    3,28,15,6,21,10,
    23,19,12,4,26,8,
    16,7,27,20,13,2,
    41,52,31,37,47,55,
    30,40,51,45,33,48,
    44,49,39,56,34,53,
    46,42,50,36,29,32
]

PC1 = [
    56,48,40,32,24,16,8,
    0,57,49,41,33,25,17,
    9,1,58,50,42,34,26,
    18,10,2,9,51,43,35,
    62,54,46,38,30,22,14,
    6,61,53,45,37,29,21,
    13,5,60,52,44,36,28,
    20,12,4,59,51,43,35
]

SHIFTS = [
    1, 1, 2, 2,
    2, 2, 2, 2,
    1, 2, 2, 2,
    2, 2, 2, 1
]



k16 = "100010110001111001001011101010001111001110100001"
k15 = "101110111001110110000111010011010011011010110011"


# Create 56-bit template filled with unknowns
template = ['?'] * 56
#print(template)
# Place known bits back into their PC-2 positions
for i, pos in enumerate(PC2):
    template[pos - 1] = k15[i]
    #print(template)

# Join into string
CD16 = ''.join(template)

print(CD16)

# Split into halves
C16 = CD16[:28]
D16 = CD16[28:]

print("C16:", C16)
print("D16:", D16)


#R16Key = 11100001?10111000?100?10?011001111?00?1010?0111100100?01
#C16: 11100001?10111000?100?10?011
#D16: 001111?00?1010?0111100100?01

#R15Key = 11110000?11011100?110?11?101100111?00?1101?0011110010?10
#C15: 11110000?11011100?110?11?101
#D15: 100111?00?1101?0011110010?10

#shifted Right C16 by 1 = 111100001?10111000?100?10?01
#shifted Right D16 by 1 = 1001111?00?1010?0111100100?0

#shiftedKey16 = 11100001?10111000?100?10?011001111?00?1010?0111100100?0

#shift = #111100001?10111000?100?10?011001111?00?1010?0111100100?0
#   OG = #11100001?10111000?100?10?011001111?00?1010?0111100100?01

#reconstructed 56bitkey idk if this is right??
#11110000111011100011001100011001111000110100011110010000

#V2
#   R15 = 11110000?11011100?110?11?101100111?00?1101?0011110010?10
#R16Key = 11100001?10111000?100?10?011001111?00?1010?0111100100?01

#KeyUncoveredR16 = 11100001110111000110011010110011110001101000111100100101

KeyUncovered = "11100001110111000110011010110011110001101000111100100101" 
#toAdd = 9, 18, 22, 25, 35, 38, 43, 54

template2 = ['?'] * 64

for i, pos in enumerate(PC1):
    template2[pos - 1] = KeyUncovered[i]
    #print(template2)

KU = ''.join(template2)
print(KU)

#0010001011010000110010001001100010110101010111011111110111001001
#22D0C898B55DFDC9

#912973465BBFECD9